{
  "version": 3,
  "sources": ["../../../src/ui/hooks/useLocalCart.ts"],
  "sourcesContent": ["import { useLocalStorage, writeStorage } from '@rehooks/local-storage';\nimport { LocalCart } from '~/use-cases/contracts/LocalCart';\n\nconst InitializeEmptyLocalCart = (): LocalCart => {\n    return {\n        items: {},\n        cartId: '',\n        state: 'cart',\n    };\n};\n\nexport function useLocalCart() {\n    const [cart] = useLocalStorage<LocalCart>('cart', InitializeEmptyLocalCart());\n    const update = (cart: LocalCart) => {\n        writeStorage('cart', {\n            ...cart,\n        });\n    };\n\n    const isImmutable = () => {\n        return cart.state === 'placed' || cart.state === 'paid';\n    };\n\n    return {\n        cart,\n        setWrappingData: (cartId: string, cartState: string) => {\n            update({\n                ...cart,\n                cartId,\n                state: cartState as 'cart' | 'placed',\n            });\n        },\n        empty: () => {\n            update({\n                ...cart,\n                ...InitializeEmptyLocalCart(),\n            });\n        },\n        isImmutable,\n        isEmpty: () => {\n            return Object.keys(cart.items).length === 0;\n        },\n        clone: () => {\n            update({\n                ...cart,\n                cartId: '',\n            });\n        },\n        add: (\n            item: {\n                name: string;\n                sku: string;\n                price: number;\n            },\n            quantity: number = 1,\n        ) => {\n            if (isImmutable()) {\n                return;\n            }\n            if (cart.items[item.sku]) {\n                cart.items[item.sku].quantity = cart.items[item.sku].quantity + quantity;\n            } else {\n                cart.items[item.sku] = {\n                    sku: item.sku,\n                    name: item.name,\n                    price: item.price,\n                    quantity: quantity,\n                };\n            }\n            update(cart);\n        },\n        remove: (item: { sku: string }) => {\n            if (isImmutable()) {\n                return;\n            }\n            if (cart.items[item.sku]) {\n                if (cart.items[item.sku].quantity >= 1) {\n                    cart.items[item.sku].quantity--;\n                }\n            }\n            const items = Object.keys(cart.items).reduce((accumulator: any, key: any) => {\n                const item = cart.items[key];\n                if (item.quantity > 0) {\n                    accumulator[item.sku] = item;\n                }\n                return accumulator;\n            }, {});\n            update({\n                ...cart,\n                items: items,\n            });\n        },\n    };\n}\n"],
  "mappings": ";;;;;;;;AAAA,2BAA8C;AAG9C,IAAM,2BAA2B,MAAiB;AAC9C,SAAO;AAAA,IACH,OAAO,CAAC;AAAA,IACR,QAAQ;AAAA,IACR,OAAO;AAAA,EACX;AACJ;AAEO,SAAS,eAAe;AAC3B,QAAM,CAAC,IAAI,QAAI,sCAA2B,QAAQ,yBAAyB,CAAC;AAC5E,QAAM,SAAS,CAACA,UAAoB;AAChC,2CAAa,QAAQ;AAAA,MACjB,GAAGA;AAAA,IACP,CAAC;AAAA,EACL;AAEA,QAAM,cAAc,MAAM;AACtB,WAAO,KAAK,UAAU,YAAY,KAAK,UAAU;AAAA,EACrD;AAEA,SAAO;AAAA,IACH;AAAA,IACA,iBAAiB,CAAC,QAAgB,cAAsB;AACpD,aAAO;AAAA,QACH,GAAG;AAAA,QACH;AAAA,QACA,OAAO;AAAA,MACX,CAAC;AAAA,IACL;AAAA,IACA,OAAO,MAAM;AACT,aAAO;AAAA,QACH,GAAG;AAAA,QACH,GAAG,yBAAyB;AAAA,MAChC,CAAC;AAAA,IACL;AAAA,IACA;AAAA,IACA,SAAS,MAAM;AACX,aAAO,OAAO,KAAK,KAAK,KAAK,EAAE,WAAW;AAAA,IAC9C;AAAA,IACA,OAAO,MAAM;AACT,aAAO;AAAA,QACH,GAAG;AAAA,QACH,QAAQ;AAAA,MACZ,CAAC;AAAA,IACL;AAAA,IACA,KAAK,CACD,MAKA,WAAmB,MAClB;AACD,UAAI,YAAY,GAAG;AACf;AAAA,MACJ;AACA,UAAI,KAAK,MAAM,KAAK,MAAM;AACtB,aAAK,MAAM,KAAK,KAAK,WAAW,KAAK,MAAM,KAAK,KAAK,WAAW;AAAA,MACpE,OAAO;AACH,aAAK,MAAM,KAAK,OAAO;AAAA,UACnB,KAAK,KAAK;AAAA,UACV,MAAM,KAAK;AAAA,UACX,OAAO,KAAK;AAAA,UACZ;AAAA,QACJ;AAAA,MACJ;AACA,aAAO,IAAI;AAAA,IACf;AAAA,IACA,QAAQ,CAAC,SAA0B;AAC/B,UAAI,YAAY,GAAG;AACf;AAAA,MACJ;AACA,UAAI,KAAK,MAAM,KAAK,MAAM;AACtB,YAAI,KAAK,MAAM,KAAK,KAAK,YAAY,GAAG;AACpC,eAAK,MAAM,KAAK,KAAK;AAAA,QACzB;AAAA,MACJ;AACA,YAAM,QAAQ,OAAO,KAAK,KAAK,KAAK,EAAE,OAAO,CAAC,aAAkB,QAAa;AACzE,cAAMC,QAAO,KAAK,MAAM;AACxB,YAAIA,MAAK,WAAW,GAAG;AACnB,sBAAYA,MAAK,OAAOA;AAAA,QAC5B;AACA,eAAO;AAAA,MACX,GAAG,CAAC,CAAC;AACL,aAAO;AAAA,QACH,GAAG;AAAA,QACH;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AACJ;",
  "names": ["cart", "item"]
}
