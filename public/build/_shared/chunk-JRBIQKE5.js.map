{
  "version": 3,
  "sources": ["../../../src/use-cases/LanguageAndMarket.ts", "../../../src/use-cases/http/cache.ts"],
  "sourcesContent": ["export const availableTranslationDomains = ['common'];\n\nexport const displayableLanguages = [\n    {\n        code: 'en',\n        name: 'EN',\n    },\n    {\n        code: 'no',\n        name: 'NO',\n    },\n];\nexport const availableLanguages = [\n    'en',\n    'no',\n    'fr',\n    'de',\n    'es',\n    'it',\n    'sv',\n    'da',\n    'nl',\n    'pt',\n    'pl',\n    'ru',\n    'ja',\n    'zh',\n    'ko',\n    'ar',\n    'tr',\n    'th',\n    'cs',\n    'hu',\n    'fi',\n    'el',\n    'he',\n    'id',\n    'ro',\n    'sk',\n    'uk',\n    'vi',\n    'bg',\n    'hr',\n    'lt',\n    'lv',\n    'sr',\n    'sl',\n    'et',\n    'ka',\n    'ms',\n    'hi',\n    'bn',\n    'ta',\n    'te',\n    'ml',\n    'ur',\n    'fa',\n    'ps',\n    'sw',\n    'am',\n    'km',\n    'lo',\n    'my',\n    'ne',\n    'si',\n    'pa',\n    'gu',\n    'mr',\n    'sa',\n    'kn',\n    'sd',\n    'or',\n    'as',\n    'ml',\n    'cy',\n    'is',\n    'mk',\n    'sq',\n    'bs',\n    'mt',\n    'af',\n    'az',\n    'be',\n    'bn',\n    'bs',\n    'ca',\n    'cs',\n    'cy',\n    'da',\n    'de',\n    'el',\n    'en',\n    'es',\n    'et',\n    'fa',\n    'fi',\n    'fr',\n    'gu',\n    'he',\n    'hi',\n    'hr',\n    'hu',\n    'hy',\n    'id',\n    'is',\n    'it',\n    'ja',\n    'ka',\n    'km',\n    'kn',\n    'ko',\n    'lt',\n    'lv',\n    'mk',\n    'ml',\n    'mr',\n    'ms',\n    'ne',\n    'nl',\n    'no',\n    'or',\n    'pa',\n    'pl',\n    'ps',\n    'pt',\n    'ro',\n    'ru',\n    'sa',\n    'sd',\n    'si',\n    'sk',\n    'sl',\n    'sq',\n    'sr',\n    'sv',\n    'sw',\n    'ta',\n    'te',\n    'th',\n    'tr',\n    'uk',\n    'ur',\n    'vi',\n    'zh',\n];\nexport const availableMarkets = [];\n\nexport const isValidLanguage = (language: string) => availableLanguages.includes(language);\n\nexport const isValidMarket = (market?: string) => {\n    if (!market) {\n        return true;\n    }\n    if (availableMarkets.length === 0) {\n        return true;\n    }\n    //@ts-ignore\n    return availableMarkets.includes(market);\n};\nexport const isValidLanguageMarket = (language: string, market?: string) => {\n    if (!isValidLanguage(language)) {\n        return false;\n    }\n    if (!isValidMarket(market)) {\n        return false;\n    }\n    return true;\n};\n\nexport const buildLanguageMarketAwareLink = (path: string, language: string, market?: string): string => {\n    if (!isValidLanguageMarket(language, market)) {\n        throw new Error(`Invalid language (${language}) or market (${market})`);\n    }\n\n    if (market && market.length > 0) {\n        return `/${language}-${market}${path}`;\n    }\n\n    return `/${language}${path}`;\n};\n", "// From https://github.com/jkroso/parse-duration\nconst parse = (duration: string, format: string): number => {\n    const durationRegexp = /(-?(?:\\d+\\.?\\d*|\\d*\\.?\\d+)(?:e[-+]?\\d+)?)\\s*([\\p{L}]*)/giu;\n    const ms = 1;\n    const sec = 1000 * ms;\n    const min = 60 * sec;\n    const hour = 60 * min;\n    const day = 24 * hour;\n    const week = 7 * day;\n    const month = (365.25 / 12) * day;\n    const year = 365.25 * day;\n    const ratios = {\n        nanosecond: ms / 1e6,\n        ns: ms / 1e6,\n        \u00B5s: ms / 1e3,\n        us: ms / 1e3,\n        microsecond: ms / 1e3,\n        millisecond: ms,\n        ms: ms,\n        second: sec,\n        sec: sec,\n        s: sec,\n        minute: min,\n        min: min,\n        m: min,\n        hour: hour,\n        hr: hour,\n        h: hour,\n        day: day,\n        d: day,\n        week: week,\n        wk: week,\n        w: week,\n        month: month,\n        b: month,\n        year: year,\n        yr: year,\n        y: year,\n    };\n\n    function unit(str: keyof typeof ratios): number | null {\n        return ratios[str] || ratios[str.toLowerCase().replace(/s$/, '') as keyof typeof ratios] || null;\n    }\n    let result = 0.0;\n    const str = duration\n        .replace(/(\\d)[,_](\\d)/g, '$1$2')\n        .replace(durationRegexp, (_, n: string, units: string): string => {\n            const convertedUnits = unit(units as keyof typeof ratios);\n            if (convertedUnits) {\n                result = (result || 0) + parseFloat(n) * convertedUnits;\n            }\n            return '';\n        });\n    return result && result / (unit(format as keyof typeof ratios) || 1);\n};\n\nexport type HttpCacheHeaders = {\n    headers: {\n        'Cache-Control': string;\n    };\n};\n\nexport type VarnishHttpCacheHeaders = Required<HttpCacheHeaders> & {\n    headers: {\n        xkey: string;\n    };\n};\n\nexport type FastlyHttpCacheHeaders = Required<HttpCacheHeaders> & {\n    headers: {\n        'Surrogate-Key': string; // Fastly cache key\n        'Surrogate-Control': string; // Fastly cache control\n    };\n};\n\nexport function HttpCacheHeaderTaggerFromLoader(\n    loader: Headers,\n): HttpCacheHeaders | VarnishHttpCacheHeaders | FastlyHttpCacheHeaders {\n    if (process.env.HTTP_CACHE_SERVICE === 'fastly') {\n        return {\n            headers: {\n                'Cache-Control': loader.get('Cache-Control') as string,\n                'Surrogate-Control': loader.get('Surrogate-Control') as string,\n                'Surrogate-Key': loader.get('Surrogate-Key') as string,\n            },\n        };\n    }\n\n    if (process.env.HTTP_CACHE_SERVICE === 'varnish') {\n        return {\n            headers: {\n                'Cache-Control': loader.get('Cache-Control') as string,\n                xkey: loader.get('xkey') as string,\n            },\n        };\n    }\n    return {\n        headers: {\n            'Cache-Control': loader.get('Cache-Control') as string,\n        },\n    };\n}\n\n/**\n * Return HTTP Cache headers\n */\nexport function HttpCacheHeaderTagger(\n    maxAge: string,\n    sharedMaxAge: string,\n    tags: string[],\n): HttpCacheHeaders | VarnishHttpCacheHeaders | FastlyHttpCacheHeaders {\n    const clean = (tag: string) => {\n        let w = tag.replace(/\\//g, '-');\n        if (w[0] === '-') {\n            w = w.substring(1);\n        }\n        return w;\n    };\n\n    if (process.env.HTTP_CACHE_SERVICE === 'fastly') {\n        // We tell Fastly to cache the response for sharedMaxAge (max-age in Surrogate-Control which has precedence over Cache-Control s-max-age)\n        // We tell Fastly to serve a stale only 2 time the sharedMaxAge\n        // We tell Fastly to serve a stale for sharedMaxAge if the origin is not available\n        // and we tell the browser to cache the response for maxAge\n        // and we tell the browser serve a stale only 2 time the maxAge\n        return {\n            headers: {\n                'Cache-Control': `public, max-age=${parse(maxAge, 's')}, s-maxage=${parse(\n                    sharedMaxAge,\n                    's',\n                )}, stale-while-revalidate=${parse(maxAge, 's')}, stale-if-error=${parse(sharedMaxAge, 's')}`,\n                'Surrogate-Control': `max-age=${parse(sharedMaxAge, 's')}, stale-while-revalidate=${parse(\n                    sharedMaxAge,\n                    's',\n                )}`,\n                'Surrogate-Key': 'all ' + tags.map(clean).join(' '),\n            },\n        };\n    }\n\n    if (process.env.HTTP_CACHE_SERVICE === 'varnish') {\n        // We tell Vanish to cache the response for sharedMaxAge\n        // We tell Vanish to serve a stale only 2 time the maxAge\n        // and we tell the browser to cache the response for maxAge\n        // and we tell the browser serve a stale only 2 time the maxAge (same header used for Varnish)\n        return {\n            headers: {\n                'Cache-Control': `public, max-age=${parse(maxAge, 's')}, s-maxage=${parse(\n                    sharedMaxAge,\n                    's',\n                )}, stale-while-revalidate=${parse(maxAge, 's')}`,\n                xkey: 'all ' + tags.map(clean).join(' '),\n            },\n        };\n    }\n\n    return {\n        headers: {\n            'Cache-Control': `public, max-age=${parse(maxAge, 's')}, s-maxage=${parse(\n                sharedMaxAge,\n                's',\n            )}, stale-while-revalidate=${parse(maxAge, 's')}`,\n        },\n    };\n}\n\nexport function StoreFrontAwaretHttpCacheHeaderTagger(\n    maxAge: string,\n    sharedMaxAge: string,\n    tags: string[],\n    prefix: string = '',\n): HttpCacheHeaders | VarnishHttpCacheHeaders | FastlyHttpCacheHeaders {\n    return HttpCacheHeaderTagger(\n        maxAge,\n        sharedMaxAge,\n        tags.map((tag: string) => `${prefix}-${tag}`),\n    );\n}\n"],
  "mappings": ";AAEO,IAAM,uBAAuB;AAAA,EAChC;AAAA,IACI,MAAM;AAAA,IACN,MAAM;AAAA,EACV;AAAA,EACA;AAAA,IACI,MAAM;AAAA,IACN,MAAM;AAAA,EACV;AACJ;AACO,IAAM,qBAAqB;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAC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",
  "names": ["str"]
}
